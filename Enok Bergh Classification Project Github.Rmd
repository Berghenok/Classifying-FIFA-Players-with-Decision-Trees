---
title: "Classifying FIFA Players with Decision Trees"
author: "Enok Bergh"
date: "2025-12-05"
output: github_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE
)
```
  
# Introduction
In this project i used a classification model to predict FIFA players position group. My idea was to use this dataset to see if a players in game attributes can predict a players optimal position on the field. So ive used skills such as pace, shooting and defending to calculate whether they are best fitted as a forward, midfield or defence player. 

I chose this topic because its a great way to have fun with data and visualizations, wile showing the real life predictions we can make with data. A decition tree also fits this dataset well so that it can be interesting to read for the general public.

# Data
The dataset is from kaggle and includes data from FIFA 15-21, that includes thousands of players attributes. Every row is a player and the collums give us basic information and spesific skills. 

For this analysis I focused on these columns:

Player name, age, height, weight, pace, shooting, passing, dribbling, defending, physic, and set positions the player can play (“ST, LW, RW”).

The original data set had more detailed positions, to make this simpler to read and more interperetable I divided them into three main groups: Forward, midfield and defender. Players outside these groups (f.ex. goalkeepers) were removed from the analysis. 

# Method
This is a supervised classification problem, witch means the model learns from the players we know the position group of, sees if other players have a similar play style, and predicts if they would have the same position.

I used a decision tree classifier (from the rpart package in R). The target variable was position_group (Forward / Midfielder / Defender). The predictors were:

Pace, shooting, passing, dribblingm, defending, physic, height_cm and weight_kg.

To evaluate the model fairly, I split the data into a 70% training set used to fit the decision tree and a 30% test set, held out and used only for evaluation.

I set a random seed to make the data split reproducible. Then I built a decision tree that splits the data into branches based on the variables that best separate the three position groups.

To evaluate the model, I predicted the position group on the test set and calculated a confusion matrix, overall accuracy, and measures showing how well the model performs for each class.

# Results
The decition tree is easy to read as a set of "if then" rules. On the top, the model is looking for the single most important attribute to seperate the classes. In this case that is defending. That makes sense when we see the pattern that players with high defence scores are more likely to be defenders, and the players with lower defence scores are more likely to be midfield or forward players depending on their attacking skills. 

Deeper in the tree we look at the other attributes than differentiate midfielders and forward players. For example, branches with higher shooting and dribbeling scores tend to be forward players, while better passers tend to be midfield. Height and weight also play a small role, but the main driver is skill rating. 


On the held-out test set, the decision tree achieved a reasonable accuracy (better than just guessing the most common class). The confusion matrix shows that:

Defenders are often classified correctly, likely because they stand out with high defending values. 

There is more confusion between Midfielders and Forwards, which is not surprising since many attacking midfielders have similar stats to second strikers or wingers.

Even though this is a fairly simple model, it is capturing meaningful patterns from the FIFA players.

To show how the model behaves for actual players, I ran the decision tree on a few of my favorite players. First up was one of Liverpool’s cornerstones, Virgil van Dijk. Unsurprisingly, the model classified him as a Defender—his defensive stats are so high in EA’s ratings that the tree basically had no choice.

I also tested Norway’s greatest hope for the 2026 World Cup, Erling Braut Haaland, and the model instantly placed him in the Forward category. With his pace, shooting power, and after seeing World cup qualifiers this year, this prediction was very much expected.

# Discussion
This project shows that a basic decision tree can use FIFA attributes to predict a players broad position group in a way that is both reasonably accurate and easy to interpret. The most important insight is that the tree reflects football logic:

High defending sharply increases the chance of being a defender. Strong shooting and dribbling are typical for forwards. And midfielders sit in between, often with balanced stats and good passing.

The main strengths of this approach are that its easy to interprerate and the model is quick to train and easy to implement in R.

However there are also limitations:

The data are based on a video game, not real match performance, so the results reflect EA’s ratings rather than “true” football ability. I also only used a small subset of all available attributes, and I ignored goalkeepers. Lastly a single decision tree can be unstable and might not give the best possible accuracy compared with more advanced methods such as random forests or gradient boosting.

Despite these limitations, the project achieves its goal: using a decision tree to classify FIFA players into forwards, midfielders and defenders, and explaining the model in a understandable way. It shows how coding can be fun while still practising important ideas like data cleaning, train/test splits, model fitting and evaluation.




```{r packages, message=FALSE, warning=FALSE}
library(tidyverse)
library(rpart)
library(rpart.plot)
library(caret)
library(readxl)


fifa <- read_excel("FIFA 15-21.xlsx")

glimpse(fifa)
head(fifa)

fifa_clean <- fifa %>%
  select(short_name, age, height_cm, weight_kg,
         pace, shooting, passing, dribbling, defending, physic,
         player_positions) %>%
  mutate(
    primary_position = str_split(player_positions, ",", simplify = TRUE)[,1] %>%
      str_trim()
  )
  
  table(fifa_clean$primary_position)

fifa_clean <- fifa_clean %>%
  mutate(position_group = case_when(
    primary_position %in% c("ST","CF","LW","RW","LF","RF") ~ "Forward",
    primary_position %in% c("CM","CAM","CDM","LM","RM") ~ "Midfielder",
    primary_position %in% c("CB","LB","RB","LWB","RWB") ~ "Defender",
    TRUE ~ NA_character_
  )) %>%
  drop_na(position_group)

fifa_clean$position_group <- factor(fifa_clean$position_group)

table(fifa_clean$position_group)

set.seed(123)

train_index <- createDataPartition(fifa_clean$position_group, p = 0.7, list = FALSE)
train <- fifa_clean[train_index, ]
test  <- fifa_clean[-train_index, ]

tree_model <- rpart(
  position_group ~ pace + shooting + passing + dribbling +
                   defending + physic + height_cm + weight_kg,
  data = train,
  method = "class"
)

rpart.plot(tree_model, type = 3, extra = 104, fallen.leaves = TRUE)

pred <- predict(tree_model, test, type = "class")

confusionMatrix(pred, test$position_group)

van_dijk <- fifa_clean %>% 
  filter(short_name == "V. van Dijk")
predict(tree_model, van_dijk, type = "class")


haaland <- fifa_clean %>% 
  filter(short_name == "E. Haaland")
predict(tree_model, haaland, type = "class")


```




